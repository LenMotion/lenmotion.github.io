(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{303:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},304:function(e,t,o){var i=o(28),a="["+o(303)+"]",r=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),n=function(e){return function(t){var o=String(i(t));return 1&e&&(o=o.replace(r,"")),2&e&&(o=o.replace(c,"")),o}};e.exports={start:n(1),end:n(2),trim:n(3)}},327:function(e,t,o){},405:function(e,t,o){"use strict";var i=o(1),a=o(117),r=o(51),c=o(20),n=o(22),s=o(179),l=o(116),u=o(75),d=o(17),h=u("splice"),m=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,p=Math.min;i({target:"Array",proto:!0,forced:!h||!m},{splice:function(e,t){var o,i,u,d,h,m,y=n(this),g=c(y.length),v=a(e,g),C=arguments.length;if(0===C?o=i=0:1===C?(o=0,i=g-v):(o=C-2,i=p(f(r(t),0),g-v)),g+o-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(u=s(y,i),d=0;d<i;d++)(h=v+d)in y&&l(u,d,y[h]);if(u.length=i,o<i){for(d=v;d<g-i;d++)m=d+o,(h=d+i)in y?y[m]=y[h]:delete y[m];for(d=g;d>g-i+o;d--)delete y[d-1]}else if(o>i)for(d=g-i;d>v;d--)m=d+o-1,(h=d+i-1)in y?y[m]=y[h]:delete y[m];for(d=0;d<o;d++)y[d+v]=arguments[d+2];return y.length=g-i+o,u}})},406:function(e,t,o){"use strict";var i=o(7),a=o(4),r=o(115),c=o(14),n=o(6),s=o(34),l=o(184),u=o(50),d=o(3),h=o(38),m=o(73).f,f=o(33).f,p=o(8).f,y=o(304).trim,g=a.Number,v=g.prototype,C="Number"==s(h(v)),b=function(e){var t,o,i,a,r,c,n,s,l=u(e,!1);if("string"==typeof l&&l.length>2)if(43===(t=(l=y(l)).charCodeAt(0))||45===t){if(88===(o=l.charCodeAt(2))||120===o)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+l}for(c=(r=l.slice(2)).length,n=0;n<c;n++)if((s=r.charCodeAt(n))<48||s>a)return NaN;return parseInt(r,i)}return+l};if(r("Number",!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var N,w=function(e){var t=arguments.length<1?0:e,o=this;return o instanceof w&&(C?d((function(){v.valueOf.call(o)})):"Number"!=s(o))?l(new g(b(t)),o,w):b(t)},_=i?m(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;_.length>x;x++)n(g,N=_[x])&&!n(w,N)&&p(w,N,f(g,N));w.prototype=v,v.constructor=w,c(a,"Number",w)}},407:function(e,t,o){"use strict";var i=o(327);o.n(i).a},411:function(e,t,o){"use strict";o.r(t);o(21),o(114),o(405),o(406),o(18);var i={name:"commodityChose",data:function(){return{queryData:{pageNum:1,pageSize:10,commodityCode:"",commodityName:"",categoryCode:""},defaultProps:{children:"productCategorys",label:"categoryName"},viewData:{categoryTree:[],goodsList:[],goodsTotal:0,choiceList:[]},choiceCodeList:[],categoryFilterText:"",defaultProp:{commodityCode:"commodityCode",commodityName:"commodityName",categoryCode:"categoryCode",categoryName:"categoryName"},defaultTableRow:[{prop:"categoryName",label:"分类名称"},{prop:"commodityCode",label:"商品编码"},{prop:"commodityName",label:"商品名称"}],choiceTableRow:[]}},props:{showCategory:{type:Boolean,default:!0},choiceType:{type:Number,default:1},confirm:{type:Boolean,default:!0},commodityList:{type:Array,default:[]},prop:{type:Object,default:function(){return{}}},maxChoice:{type:Number,default:0},choiceTableHeader:{type:Array,default:function(){return[0,1,2]}},visible:{type:Boolean,default:!1},checkCommodity:{type:Function,default:function(e){return Promise.resolve()}},checkCommoditySingle:{type:Function,default:function(e){return Promise.resolve()}}},methods:{queryCategory:function(){var e=this,t=this.getLoading(".commodity-choice");this.axios.get(this.api.commodity.category).then((function(o){t.close(),e.viewData.categoryTree=o}))},initCategory:function(e){if(e)for(var t in e)e[t]=this.paramsClear(e[t]),e[t].productCategorys&&(e[t].productCategorys=this.initCategory(e[t].productCategorys));return e},handleNodeClick:function(e){this.queryData.categoryCode=e.categoryCode,this.queryGoods()},queryGoods:function(e,t){var o=this,i=this.queryData,a={pageNum:e||i.pageNum,pageSize:t||i.pageSize},r=this.api.commodity.list+"?"+this.jsonToParams(a),c=this.getLoading(".commodity-choice");this.axios.post(r,i).then((function(e){c.close(),o.viewData.goodsTotal=e?e.total:0,o.viewData.goodsList=e?e.result:[]}))},handleCommodityInfo:function(e){var t={};for(var o in this.defaultProp)t[this.defaultProp[o]]=e[o];return t},handleCommodityList:function(e){var t=[];for(var o in e)t.push(this.handleCommodityInfo(e[o]));return t},transitionCommodityList:function(e){var t=[];for(var o in e){var i=e[o],a={};for(var r in this.defaultProp)a[r]=i[this.defaultProp[r]];t.push(a)}return t},choiceCommodity:function(e){var t=this;if(1==this.choiceType){var o=this.handleCommodityInfo(e);this.checkCommoditySingle(o).then((function(e){t.clearChoice(),t.$emit("choice-single",o)})).catch((function(e){console.log("校验失败！")}))}else if(2==this.choiceType){if(this.maxChoice>0&&this.choiceCodeList.length>=this.maxChoice)return this.$message.error("最多只能选择".concat(this.maxChoice,"个商品!"));var i=this.handleCommodityInfo(e);this.checkCommoditySingle(i).then((function(o){t.choiceCodeList.push(e.commodityCode),t.viewData.choiceList.push(Object.assign({},e))})).catch((function(e){console.log("校验失败！")})),this.confirm||this.confirmChoice()}},confirmChoice:function(){var e=this,t=this.handleCommodityList(this.viewData.choiceList);this.checkCommodity(t).then((function(o){e.$emit("choice-list",t),e.clearChoice()})).catch((function(e){console.log("校验失败！")}))},removeCommodity:function(e){this.choiceCodeList.splice(e,1),this.viewData.choiceList.splice(e,1)},searchCategory:function(){this.$refs.categoryTree.filter(this.categoryFilterText)},filterNode:function(e,t){return-1!==t.categoryName.indexOf(e)},cencelChoice:function(){this.clearChoice(),this.$emit("choice-cancel")},closeChoice:function(){this.$emit("update:visible",!1)},clearChoice:function(){this.closeChoice(),this.viewData.choiceList=[],this.choiceCodeList=[]}},mounted:function(){this.queryCategory()},watch:{visible:function(e,t){if(e){for(var o in this.defaultProp=Object.assign(this.defaultProp,this.prop),this.queryData.pageNum=1,this.queryGoods(),this.viewData.choiceList=this.transitionCommodityList(this.commodityList),this.choiceCodeList=[],this.viewData.choiceList)this.choiceCodeList.push(this.viewData.choiceList[o].commodityCode);for(var i in this.choiceTableRow=[],this.choiceTableHeader)this.choiceTableRow.push(this.defaultTableRow[this.choiceTableHeader[i]])}}}},a=(o(407),o(47)),r=Object(a.a)(i,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"commodity-choice"},[o("el-dialog",{attrs:{title:"选择商品",visible:e.visible,"close-on-click-modal":!1,top:"30px",width:"1200px"},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.closeChoice()}}},[o("el-row",{attrs:{gutter:20}},[e.showCategory?o("el-col",{staticClass:"commodity-list",attrs:{span:6}},[o("el-form",{attrs:{inline:!0,size:"mini"}},[o("el-form-item",{attrs:{label:""}},[o("el-input",{attrs:{placeholder:"请输入类别"},model:{value:e.categoryFilterText,callback:function(t){e.categoryFilterText=t},expression:"categoryFilterText"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.searchCategory}},[e._v("搜索")])],1)],1),e._v(" "),o("el-tree",{ref:"categoryTree",attrs:{data:e.viewData.categoryTree,props:e.defaultProps,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1):e._e(),e._v(" "),o("el-col",{staticClass:"commodity-list",attrs:{span:e.showCategory?18:24}},[o("el-form",{attrs:{inline:!0,model:e.queryData,size:"mini"}},[o("el-form-item",{attrs:{label:"商品名称:"}},[o("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.queryData.commodityName,callback:function(t){e.$set(e.queryData,"commodityName",t)},expression:"queryData.commodityName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"商品编码:"}},[o("el-input",{attrs:{placeholder:"请输入商品编码"},model:{value:e.queryData.commodityCode,callback:function(t){e.$set(e.queryData,"commodityCode",t)},expression:"queryData.commodityCode"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.queryGoods(1,10)}}},[e._v("查询")])],1)],1),e._v(" "),o("el-table",{attrs:{data:e.viewData.goodsList,border:""}},[o("el-table-column",{attrs:{type:"index",width:"40"}}),e._v(" "),o("el-table-column",{attrs:{prop:"categoryName",label:"所属分类",width:"145"}}),e._v(" "),o("el-table-column",{attrs:{prop:"commodityCode",label:"商品编码",width:"135"}}),e._v(" "),o("el-table-column",{attrs:{prop:"commodityName",label:"商品名称"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.choiceCodeList.indexOf(t.row.commodityCode)>-1?o("el-link",{attrs:{type:"info",disabled:""}},[e._v("已选择\n              ")]):o("el-link",{attrs:{type:"primary"},on:{click:function(o){return e.choiceCommodity(t.row)}}},[e._v("选择\n              ")])]}}])})],1),e._v(" "),o("el-pagination",{staticStyle:{"margin-top":"10px",float:"right"},attrs:{background:"",small:"",layout:"total, prev, pager, next, jumper","current-page":e.queryData.pageNum,total:e.viewData.goodsTotal},on:{"update:currentPage":function(t){return e.$set(e.queryData,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryData,"pageNum",t)},"current-change":e.queryGoods}}),e._v(" "),o("div",{staticStyle:{clear:"both"}})],1)],1),e._v(" "),2==e.choiceType?o("div",{staticClass:"choice-div"},[o("el-card",{staticClass:"box-card"},[o("div",{attrs:{slot:"header"},slot:"header"},[o("span",[e._v("选中的商品")])]),e._v(" "),o("el-table",{attrs:{data:e.viewData.choiceList,border:""}},[o("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),e._l(e.choiceTableRow,(function(e){return o("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("opt-remove",[o("el-link",{attrs:{type:"danger",size:"mini"},on:{click:function(o){return e.removeCommodity(t.$index)}}},[e._v("删除")])],{commodity:t.row,index:t.$index,choiceList:e.viewData.choiceList}),e._v(" "),e._t("opt",null,{commodity:t.row,index:t.$index,choiceList:e.viewData.choiceList})]}}],null,!0)})],2),e._v(" "),e.confirm?o("div",{staticClass:"confirm-div"},[o("el-button",{attrs:{size:"small"},on:{click:e.cencelChoice}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmChoice}},[e._v("确定")])],1):e._e()],1)],1):e._e()],1)],1)}),[],!1,null,null,null);t.default=r.exports}}]);